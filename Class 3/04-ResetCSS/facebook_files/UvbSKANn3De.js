if (self.CavalryLogger) { CavalryLogger.start_js(["j5xP1"]); }

__d("PrivacySelectorEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPEN_MENU:"open_menu",CLOSE_MENU:"close_menu",MORE_OPTIONS:"more_options",MORE:"more",SEE_ALL:"see_all",CUSTOM_SAVE:"custom_save",CUSTOM_CANCEL:"custom_cancel",SELECT_CUSTOM:"select_custom",SPECIFIC_FRIENDS_SAVE:"specific_friends_save",SPECIFIC_FRIENDS_CANCEL:"specific_friends_cancel",SELECT_SPECIFIC_FRIENDS:"select_specific_friends",FRIENDS_EXCEPT_SAVE:"friends_except_save",FRIENDS_EXCEPT_CANCEL:"friends_except_cancel",SELECT_FRIENDS_EXCEPT:"select_friends_except",SELECT_EVERYONE:"select_everyone",SELECT_FRIENDS_OF_FRIENDS:"select_friends_of_friends",SELECT_FRIENDS:"select_friends",SELECT_FRIENDS_EXCEPT_ACQUIANTANCES:"select_friends_except_acquaintances",SELECT_ONLY_ME:"select_only_me",SELECT_FB_ONLY:"select_fb_only",SELECT_FRIENDLIST:"select_friendlist",SELECT_OTHER:"select_other"})}),null);
__d("PrivacySelectorSelectableItem",["csx","cx","CSS","DOM","DOMQuery","MenuSelectableItem","React"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j="._o00",k="._o01",l="._po2";c=babelHelpers.inherits(a,b("MenuSelectableItem"));i=c&&c.prototype;function a(a){"use strict";if(a.icon){var c="_392n _1rwt";a.children?a.icon=b("React").createElement("div",{className:c},a.icon):a.icon=b("DOM").create("div",{className:c},a.icon)}i.constructor.call(this,a)}a.prototype.render=function(){"use strict";var a=i.render.call(this),c=b("DOMQuery").find(a,"._54nh");b("CSS").addClass(c,"_4chm");c=c.parentNode;b("CSS").addClass(c,"_4chl");var d=b("DOMQuery").scry(a,"._392n")[0];d||b("CSS").addClass(c,"_4857");return a};a.prototype.isMoreButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),j)};a.prototype.isMoreOptionsButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),l)};a.prototype.isSeeAllButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),k)};e.exports=a}),null);
__d("PrivacySelectorOptionNew",["csx","cx","fbt","CSS","DOM","DOMQuery","JSXDOM","PrivacyConst","PrivacySelectorEvent","PrivacySelectorSelectableItem"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j;c=babelHelpers.inherits(a,b("PrivacySelectorSelectableItem"));j=c&&c.prototype;function a(a){"use strict";j.constructor.call(this,a),this._origLabel=this.getLabel(),this._origTriggerLabel=this.getTriggerLabel()}a.prototype._getData=function(){"use strict";return this._data};a.prototype.getTooltip=function(){"use strict";return this._getData().tooltip};a.prototype.getPostParam=function(){"use strict";return this._getData().postParam.toString()};a.prototype.setPostParam=function(a){"use strict";this._getData().postParam=a;return this};a.prototype.getSubtitles=function(){"use strict";return this._data.optionSubtitles};a.prototype.setSubtitles=function(a){"use strict";this._data.optionSubtitles!=null&&(this._data.optionSubtitles=a);return this};a.prototype.getTriggerIcon=function(){"use strict";return this._getData().triggerIcon};a.prototype.getTriggerLabel=function(){"use strict";return this._getData().triggerLabel};a.prototype.getIconType=function(){"use strict";return this._getData().iconType};a.prototype.isPublic=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.EVERYONE.toString()};a.prototype.isFriendsOfFriends=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS_OF_FRIENDS.toString()};a.prototype.isFriends=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS.toString()};a.prototype.isFriendsExceptAcquaintances=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS_MINUS_ACQUAINTANCES.toString()};a.prototype.isOnlyMe=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.ONLY_ME.toString()};a.prototype.isFBOnly=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FB_ONLY.toString()};a.prototype.isFriendlist=function(){"use strict";return this._data.isFriendlist};a.prototype.isBasicOption=function(){"use strict";return!0};a.prototype.isCustomOption=function(){"use strict";return!1};a.prototype.isSavedCustomOption=function(){"use strict";return!1};a.prototype.isPrivateSharingDisabledOption=function(){"use strict";return!1};a.prototype.getSavedCustomPrivacyType=function(){"use strict";return null};a.prototype.getTagExpansionBehavior=function(){"use strict";return this._getData().tagExpansionBehavior};a.prototype.getBaseValue=function(){"use strict";return this._getData().baseValue};a.prototype.getIndex=function(){"use strict";return this._getData().value};a.prototype.getLoggingEventName=function(){"use strict";__p&&__p();if(this.isPublic())return b("PrivacySelectorEvent").SELECT_EVERYONE;else if(this.isFriendsOfFriends())return b("PrivacySelectorEvent").SELECT_FRIENDS_OF_FRIENDS;else if(this.isFriends())return b("PrivacySelectorEvent").SELECT_FRIENDS;else if(this.isFriendsExceptAcquaintances())return b("PrivacySelectorEvent").SELECT_FRIENDS_EXCEPT_ACQUIANTANCES;else if(this.isOnlyMe())return b("PrivacySelectorEvent").SELECT_ONLY_ME;else if(this.isFBOnly())return b("PrivacySelectorEvent").SELECT_FB_ONLY;else if(this.isFriendlist())return b("PrivacySelectorEvent").SELECT_FRIENDLIST;else return b("PrivacySelectorEvent").SELECT_OTHER};a.prototype.updateAfterTagExpansion=function(a,b){"use strict";var c=this._origLabel,d=this._origTriggerLabel;a&&this._getData().showPlusOnTagExpansion&&(c=i._("{privacyLabel} (+)",[i._param("privacyLabel",c)]),b&&this.isFriends()?d=i._("Friends, Friends of Tagged"):d=i._("{privacyLabel} (+)",[i._param("privacyLabel",d)]));this._setLabel(c);this._getData().triggerLabel=d;b=this._getExpansionType(a);c=this._getData().optionSubtitles||{};this._setSubtitle(c[b])};a.prototype.isBelowSoftFold=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),"._4mwj")};a.prototype.isBelowFold=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),"._3ey_")};a.prototype.removeOnBootload=function(){"use strict";return!!this._getData().removeOnBootload};a.prototype._setLabel=function(a){"use strict";if(!a)return;var c=b("DOMQuery").find(this.getRoot(),"._54nh");c&&b("DOM").setContent(c,a);this._getData().label=a};a.prototype._setSubtitle=function(a){"use strict";if(!a)return;var c=b("DOMQuery").scry(this.getRoot(),"._48u1");c&&c[0]&&b("DOM").setContent(c[0],a)};a.prototype._getExpansionType=function(a){"use strict";return a?b("PrivacyConst").ExpansionType.TAGS_ONLY:b("PrivacyConst").ExpansionType.NONE};a.prototype.render=function(){"use strict";__p&&__p();var a=j.render.call(this);if(!this._getData().isPrimaryOption)return a;var c=b("DOMQuery").find(a,"._54nc");c&&b("CSS").addClass(c,"_48t_");var d=b("DOMQuery").scry(a,"._392n")[0];!d&&c&&b("CSS").addClass(c,"_4zfs");d=b("DOM").find(a,"._54nh");d&&b("CSS").addClass(d,"_48u0");d=b("JSXDOM").div({className:"_48u1"},this._getData().optionSubtitle);b("DOM").appendContent(c,d);return a};e.exports=a}),null);
__d("XPrivacySelectorLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/selector/log/",{event:{type:"Enum",required:!0,enumType:1},render_location:{type:"Enum",required:!0,enumType:1},content_type:{type:"String",required:!0},privacy_fbid:{type:"String"},saved_custom_opt_in:{type:"Bool",defaultValue:!1}})}),null);
__d("PrivacySelectorCustomOption",["invariant","AsyncDialog","AsyncRequest","DataStore","PrivacySelectorEvent","PrivacySelectorOptionNew","XPrivacyCustomDialogController","XPrivacySelectorLoggingController"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=babelHelpers.inherits(a,b("PrivacySelectorOptionNew"));h=c&&c.prototype;function a(a){"use strict";h.constructor.call(this,a),this._subtitlesWhenNotSelected=a.optionSubtitlesWhenNotSelected}a.prototype.isBasicOption=function(){"use strict";return!1};a.prototype.isCustomOption=function(){"use strict";return!0};a.prototype.getSelector=function(){"use strict";return this._selector};a.prototype.getLoggingEventName=function(){"use strict";return b("PrivacySelectorEvent").SELECT_CUSTOM};a.prototype.setSubtitlesToNonSelected=function(){"use strict";this.setSubtitles(this._subtitlesWhenNotSelected)};a.prototype.openDialog=function(a){"use strict";__p&&__p();this._selector==null&&(this._selector=a);b("DataStore").set(this._data.id,"PrivacySelectorCustomOption",this);var c=b("XPrivacyCustomDialogController").getURIBuilder().setString("option_id",this._data.id).setString("id",this._data.privacyfbid.toString()).setString("post_param",a.getPostParam()).setString("content_type",a.getContentType()).setEnum("render_location_enum",a.getRenderLocation()).setIntVector("tags",a.getTags()).setBool("autosave",this._data.autosave).setBool("limit_community",this._data.limitcommunity).setBool("limit_facebook",this._data.limitfacebook).setBool("limit_fof",this._data.limitfof).setBool("limit_tagexpand",this._data.limittagexpand).setBool("is_new_privacy_selector",!0).setBool("saved_custom_opt_in",a.getSavedCustomOptIn()).getURI();c=new(b("AsyncRequest"))(c);c.setRelativeTo(a.getTriggerButtonElement());b("AsyncDialog").send(c,function(c){__p&&__p();var d=function(a){var c=document.getElementsByName("render_location")[0];c instanceof HTMLInputElement||g(0,706);var d=document.getElementsByName("content_type")[0];d instanceof HTMLInputElement||g(0,706);a=b("XPrivacySelectorLoggingController").getURIBuilder().setEnum("event",a).setString("privacy_fbid",this._data.privacyfbid!=null?String(this._data.privacyfbid):null).setEnum("render_location",c.value).setString("content_type",d.value).getURI();new(b("AsyncRequest"))().setURI(a).send()}.bind(this);c.subscribe("hide",function(){a.inform("custom/hide"),a.inform("selectorFinished")});c.subscribe("success",function(){a.inform("custom/success"),d(b("PrivacySelectorEvent").CUSTOM_SAVE)});c.subscribe("cancel",function(){a.inform("custom/cancel"),d(b("PrivacySelectorEvent").CUSTOM_CANCEL)})}.bind(this))};a.customPrivacySave=function(a,c,d,e){__p&&__p();e===void 0&&(e={});var f=b("DataStore").get(a,"PrivacySelectorCustomOption");b("DataStore").remove(a,"PrivacySelectorCustomOption");if(!(f==null))if(!(f.getSelector==null)){a=f.getSelector();d!==null?a.updateSavedCustomOption(d,c,e):a.updateCustomOption(e);a.selectOption(c);a.finishAnimatingSavedCustomSave()}};e.exports=a}),null);
__d("XPrivacySelectorAsyncMoreController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/selector/async_more/",{id:{type:"String",required:!0},next_value:{type:"Int",required:!0},render_location_enum:{type:"Enum",required:!0,enumType:1}})}),null);
__d("PrivacySelectableMenu",["cx","Arbiter","AsyncRequest","CSS","DataStore","Ease","PrivacySelectorCustomOption","PrivacySelectorEvent","PrivacySelectorOptionNew","PrivacySelectorSelectableItem","SelectableMenu","SelectableMenuUtils","XPrivacySelectorAsyncMoreController","XPrivacySelectorLoggingController"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=babelHelpers.inherits(a,b("SelectableMenu"));h=c&&c.prototype;function a(a,c){"use strict";h.constructor.call(this,a,c),b("DataStore").set("PrivacySelectableMenu",c.id,this),this._needsBootload=!!c.needsbootload,this.collapseMenu(),this.updateOptionsAfterTagExpansion(!!c.hasTags)}a.prototype.cleanup=function(){"use strict";b("DataStore").remove("PrivacySelectableMenu",this._config.id)};a.prototype.getItemForIndex=function(a){"use strict";return this.findOption(function(b){return b.getIndex()==a})};a.prototype.findItem=function(a){"use strict";__p&&__p();for(var c=this._items,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;if(f instanceof b("PrivacySelectorSelectableItem")&&a(f))return f}return null};a.prototype.findOption=function(a){"use strict";return this.findItem(function(c){return c instanceof b("PrivacySelectorOptionNew")&&a(c)})};a.prototype.getSelectedOption=function(){"use strict";return this.findOption(function(a){return a.isSelected()})};a.prototype.selectOption=function(a){"use strict";__p&&__p();var c=null,d=!1,e=!1;for(var f=this._items,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;if(!(i instanceof b("PrivacySelectorSelectableItem")))continue;if(i instanceof b("PrivacySelectorCustomOption")){c=i;continue}if(i.isMoreButton()){this.expandMenuWithMore();continue}if(i.isMoreOptionsButton()||i.isSeeAllButton()){this._needsBootload?d=!0:this.expandMenu();continue}if(!d&&i instanceof b("PrivacySelectorOptionNew")&&i.getPostParam()==a){this.setValue(i.getIndex());e=!0;break}}!e&&c&&(c.setPostParam(a),this.setValue(c.getIndex()));d?(this.subscribeOnce("expandMenu",function(){this.selectOption(a)}.bind(this)),this.expandMenu()):this.inform("selectOption");return!d};a.prototype._handleItemClick=function(a,c){"use strict";__p&&__p();if(!b("SelectableMenuUtils").doesItemSupportSelect(a))return h._handleItemClick.call(this,a,c);if(a.isMoreButton()){this._logMoreButtonClick();this.expandMenuWithMore();return void 0}if(a.isMoreOptionsButton()||a.isSeeAllButton()){this._logMoreOptionsOrSeeAllButtonClick();this.expandMenu();return void 0}if(!(a instanceof b("PrivacySelectorOptionNew")))return void 0;this._logOptionClick(a);c=this.inform("itemclick",{item:a,event:c});if(c)return void 0;!b("SelectableMenuUtils").isSelected(a)&&!a.isCustomOption()&&!a.isSavedCustomOption()&&a.select()!==!1&&(this._items.forEach(function(c){b("SelectableMenuUtils").isSelected(c)&&c!==a&&c.deselect()}),this.inform("change",this.getSelection()));b("Arbiter").inform("composerprivacy/aborteducation");this.done();return a.handleClick()};a.prototype._logMoreButtonClick=function(){"use strict";var a=b("XPrivacySelectorLoggingController").getURIBuilder().setString("content_type",this._config.contenttype).setEnum("event",b("PrivacySelectorEvent").MORE).setString("privacy_fbid",this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum("render_location",this._config.renderlocation).setBool("saved_custom_opt_in",this._config.savedCustomOptIn).getURI();new(b("AsyncRequest"))().setURI(a).send()};a.prototype._logMoreOptionsOrSeeAllButtonClick=function(){"use strict";var a=this._config.hasSavedCustom?b("PrivacySelectorEvent").SEE_ALL:b("PrivacySelectorEvent").MORE_OPTIONS;a=b("XPrivacySelectorLoggingController").getURIBuilder().setString("content_type",this._config.contenttype).setEnum("event",a).setString("privacy_fbid",this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum("render_location",this._config.renderlocation).setBool("saved_custom_opt_in",this._config.savedCustomOptIn).getURI();new(b("AsyncRequest"))().setURI(a).send()};a.prototype._logOptionClick=function(a){"use strict";a=b("XPrivacySelectorLoggingController").getURIBuilder().setString("content_type",this._config.contenttype).setEnum("event",a.getLoggingEventName()).setString("privacy_fbid",this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum("render_location",this._config.renderlocation).setBool("saved_custom_opt_in",this._config.savedCustomOptIn).getURI();new(b("AsyncRequest"))().setURI(a).send()};a.prototype._getMoreOptionsOrSeeAllButton=function(){"use strict";return this.findItem(function(a){return a.isMoreOptionsButton()||a.isSeeAllButton()})};a.prototype.getCustomItem=function(){"use strict";return this.findOption(function(a){return a instanceof b("PrivacySelectorCustomOption")})};a.prototype._setMenuState=function(a){"use strict";var c=this.getRoot();b("CSS").conditionClass(c,"_po3",a!=="expanded");b("CSS").conditionClass(c,"_po4",a==="expanded");this._config.hasSavedCustom&&(b("CSS").conditionClass(c,"_n_v",a==="collapsed"),b("CSS").conditionClass(c,"_n__",a!=="collapsed"));this._expanded=a==="expanded"};a.prototype.expandMenuWithMore=function(){"use strict";this._setMenuState("withMore"),this.inform("expandMenuWithMore")};a.prototype.expandMenu=function(){"use strict";__p&&__p();if(this._expanded)return;this._setMenuState("withMore");this._expanded=!0;if(!this._needsBootload){this.expandMenuAfterLoaded();return}this._needsBootload=!1;var a=this._getMoreOptionsOrSeeAllButton();a&&(this._moreOptionsIcon=a.getIcon(),a.setIcon(this._config.morespinner),this._scrollToOption(a));var c=Date.now(),d=b("XPrivacySelectorAsyncMoreController").getURIBuilder().setString("id",this._config.id).setInt("next_value",this._config.nextvalue).setEnum("render_location_enum",this._config.renderlocation).getURI();new(b("AsyncRequest"))().setURI(d).setRelativeTo(this.getRoot()).setErrorHandler(function(b){b=1250-(Date.now()-c);setTimeout(function(){a&&a.setIcon(this._moreOptionsIcon),this._needsBootload=!0,this._expanded=!1}.bind(this),b>0&&a?b:0)}.bind(this)).send()};a.prototype.expandMenuAfterLoaded=function(){"use strict";this._setMenuState("expanded");if(this._moreOptionsIcon){var a=this._getMoreOptionsOrSeeAllButton();a&&a.setIcon(this._moreOptionsIcon);this._moreOptionsIcon=void 0}this.inform("expandMenu")};a.prototype.collapseMenu=function(){"use strict";this._setMenuState("collapsed")};a.prototype.updateOptionsAfterTagExpansion=function(a){"use strict";this._lastHasTagsUpdate=a,this.forEachItem(function(c){c instanceof b("PrivacySelectorOptionNew")&&c.updateAfterTagExpansion(a,!!this._config.hasSimpleLabels)}.bind(this))};a.prototype.refreshTagExpansionLabels=function(){"use strict";this.updateOptionsAfterTagExpansion(!!this._lastHasTagsUpdate)};a.prototype.updateTagExpansionLabelAfterBootload=function(){"use strict";this.refreshTagExpansionLabels()};a.prototype.onPopoverOpen=function(a){"use strict";a&&a.isBelowFold()?(this._needsBootload&&this.subscribeOnce("expandMenu",function(){var a=this.getSelectedOption();a&&this._scrollToOption(a)}.bind(this)),this.expandMenu(),this._needsBootload||this._scrollToOption(a)):a&&a.isBelowSoftFold()?(this.expandMenuWithMore(),this._scrollToOption(a)):this.collapseMenu()};a.prototype._scrollToOption=function(a){"use strict";if(!this._scrollableArea)return;a=a.getRoot();if(a===null)return;var c=12,d=this._scrollableArea.getScrollTop(),e=d+this._scrollableArea.getClientHeight();a=a.offsetTop+a.offsetHeight;a+c>e&&this._scrollableArea.setScrollTop(d+a+c-e,!0,{duration:Math.min(1e3,(a+c-e)*10),ease:b("Ease").sineOut})};e.exports=a}),null);
__d("PopoverButton",["csx","DOM","DOMQuery","isTextNode"],(function(a,b,c,d,e,f,g){__p&&__p();a={setLabel:function(a,c){a=b("DOMQuery").find(a,"._55pe");var d=a.childNodes;for(var e=0;e<d.length;e++)if(b("isTextNode")(d[e])){b("DOM").replace(d[e],c);return}b("DOM").appendContent(a,c)}};e.exports=a}),null);
__d("PrivacyIconType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({EVERYONE:"everyone",CUSTOM:"custom",FRIENDS:"friends",FRIENDS_OF_FRIENDS:"friends_of_friends",FRIENDS_EXCEPT_ACQUAINTANCES:"friends_except_acquaintances",FRIENDS_EXCEPT:"friends_except",SPECIFIC_FRIENDS:"specific_friends",MUTUAL_FRIENDS:"mutual_friends",ONLY_ME:"only_me",GROUP:"group",FACEBOOK:"facebook",SCHOOL_GROUP:"school_group",WORK_COMMUNITY:"work_community",WORK_MULTI_COMPANY:"work_multi_company",LIST_MEMBERS:"list_members",GENERIC_LIST:"generic_list",CLOSE_FRIENDS:"close_friends",GOOD_FRIENDS:"good_friends",ACQUAINTANCES:"acquaintances",SCHOOL_LIST:"school_list",FAMILY_LIST:"family_list",LOCATION_LIST:"location_list",WORK_LIST:"work_list",APP_LIST:"app_list",GAMER_FRIENDS:"gamer_friends",RESTRICTED:"restricted",SUBSCRIBED_LIST:"subscribed_list",SUBSCRIBED_TO:"subscribed_to",STORY_FRIENDS_AND_CONNECTIONS:"story_friends_and_connections",STORY_CUSTOM:"story_custom",ACQUAINTANCES_MOBILE_DEPRECATED:"acquaintances_mobile_deprecated",APP_LIST_ARCHIVED_MOBILE_DEPRECATED:"app_list_archived_mobile_deprecated",APP_LIST_MOBILE_DEPRECATED:"app_list_mobile_deprecated",ARCHIVED_APP_LIST:"archived_app_list",CLOSE_FRIENDS_MOBILE_DEPRECATED:"close_friends_mobile_deprecated",FAMILY_LIST_ARCHIVED_DEPRECATED:"family_list_archived_deprecated",FAMILY_LIST_ARCHIVED_MOBILE_DEPRECATED:"family_list_archived_mobile_deprecated",FAMILY_LIST_MOBILE_DEPRECATED:"family_list_mobile_deprecated",GENERIC_LIST_MOBILE_DEPRECATED:"generic_list_mobile_deprecated",GOOD_FRIENDS_DEPRECATED:"good_friends_deprecated",LOCATION_LIST_ARCHIVED_DEPRECATED:"location_list_archived_deprecated",LOCATION_LIST_ARCHIVED_MOBILE_DEPRECATED:"location_list_archived_mobile_deprecated",LOCATION_LIST_MOBILE_DEPRECATED:"location_list_mobile_deprecated",RESTRICTED_MOBILE_DEPRECATED:"restricted_mobile_deprecated",SCHOOL_LIST_ARCHIVED_DEPRECATED:"school_list_archived_deprecated",SCHOOL_LIST_ARCHIVED_MOBILE_DEPRECATED:"school_list_archived_mobile_deprecated",SCHOOL_LIST_MOBILE_DEPRECATED:"school_list_mobile_deprecated",SUBSCRIBED_LIST_MOBILE_DEPRECATED:"subscribed_list_mobile_deprecated",SUBSCRIBED_TO_ARCHIVED_DEPRECATED:"subscribed_to_archived_deprecated",SUBSCRIBED_TO_ARCHIVED_MOBILE_DEPRECATED:"subscribed_to_archived_mobile_deprecated",SUBSCRIBED_TO_MOBILE_DEPRECATED:"subscribed_to_mobile_deprecated",WORK_LIST_ARCHIVED_DEPRECATED:"work_list_archived_deprecated",WORK_LIST_ARCHIVED_MOBILE_DEPRECATED:"work_list_archived_mobile_deprecated",WORK_LIST_MOBILE_DEPRECATED:"work_list_mobile_deprecated",EVENT:"event",PRIVATE_EVENT:"private_event",PROFILE_CHANNELS_HIDDEN:"profile_channels_hidden",SUPPORTER_EXCLUSIVE:"supporter_exclusive",TOP_FAN_EXCLUSIVE:"top_fan_exclusive",NEWS_SUBSCRIBER_EXCLUSIVE:"news_subscriber_exclusive",NO_ICON:"no_icon"})}),null);
__d("PrivacySelectorDataStore",["ArbiterMixin","KeyedCallbackManager","PrivacySelectorNewDispatcher"],(function(a,b,c,d,e,f){__p&&__p();var g=new(b("KeyedCallbackManager"))(),h=babelHelpers["extends"]({},b("ArbiterMixin"),{get:function(a,b){g.executeOrEnqueue(a,b)},hasValueChanged:function(a){return!!g.getResource(a)}});b("PrivacySelectorNewDispatcher").register(function(a){a.saved_custom_privacy_type!=null&&(g.addResourcesAndExecute({saved_custom_update:{postParam:a.post_param,savedCustomPrivacyType:a.saved_custom_privacy_type,sourceSelectorID:a.unique_id,subtitles:a.subtitles}}),h.inform("saved_custom_update"));if(a.selector_type){var b={};b[a.selector_type]={post_param:a.post_param,unique_id:a.unique_id,reload:a.reload,is_error:a.is_error,is_custom:a.is_custom,selector_type:a.selector_type,subtitles:a.subtitles};g.addResourcesAndExecute(b);h.inform("change")}});e.exports=h}),null);
__d("SavedCustomPrivacyType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SPECIFIC_FRIENDS:"specific_friends",FRIENDS_EXCEPT:"friends_except"})}),null);
__d("XPrivacySpecificAudienceSelectorDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/specific_audience_selector_dialog/",{autosave:{type:"Bool",defaultValue:!1},content_type:{type:"String"},fbid:{type:"String",required:!0},option_id:{type:"String"},post_param:{type:"String"},privacy_type:{type:"Enum",required:!0,enumType:1},render_location:{type:"Enum",required:!0,enumType:1},return_uri:{type:"String"},cancel_uri:{type:"String"}})}),null);
__d("PrivacySelectorSavedCustomOption",["AsyncDialog","AsyncRequest","DataStore","PrivacySelectorEvent","PrivacySelectorOptionNew","SavedCustomPrivacyType","XPrivacySpecificAudienceSelectorDialogController"],(function(a,b,c,d,e,f){__p&&__p();var g;a=babelHelpers.inherits(h,b("PrivacySelectorOptionNew"));g=a&&a.prototype;function h(a){"use strict";g.constructor.call(this,a)}h.prototype.getSelector=function(){"use strict";return this._selector};h.prototype.isBasicOption=function(){"use strict";return!1};h.prototype.isSavedCustomOption=function(){"use strict";return!0};h.prototype.getSavedCustomPrivacyType=function(){"use strict";return this._data.savedCustomPrivacyType};h.prototype.getLoggingEventName=function(){"use strict";switch(this._data.savedCustomPrivacyType){case b("SavedCustomPrivacyType").FRIENDS_EXCEPT:return b("PrivacySelectorEvent").SELECT_FRIENDS_EXCEPT;case b("SavedCustomPrivacyType").SPECIFIC_FRIENDS:return b("PrivacySelectorEvent").SELECT_SPECIFIC_FRIENDS;default:return b("PrivacySelectorEvent").SELECT_OTHER}};h.prototype.openDialog=function(a){"use strict";this._selector=a;b("DataStore").set(this._data.id,"PrivacySelectorCustomOption",this);var c=b("XPrivacySpecificAudienceSelectorDialogController").getURIBuilder().setBool("autosave",this._data.autosave).setString("content_type",a.getContentType()).setString("fbid",this._data.privacyFBID).setString("option_id",this._data.id).setString("post_param",this.getPostParam()).setEnum("privacy_type",this._data.savedCustomPrivacyType).setEnum("render_location",a.getRenderLocation()).getURI();c=new(b("AsyncRequest"))().setURI(c).setRelativeTo(a.getTriggerButtonElement());b("AsyncDialog").send(c)};h.informSave=function(a){"use strict";a=b("DataStore").get(a,"PrivacySelectorCustomOption");if(a instanceof h){a=a.getSelector();a&&a.animateSavedCustomSave()}};e.exports=h}),null);
__d("XPrivacySelectorSavedCustomUpdateController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/selector/update/saved_custom/",{})}),null);
__d("XPrivacySelectorUpdateController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/selector/update/",{privacy_fbid:{type:"String",required:!0},post_param:{type:"String",required:!0},tags:{type:"IntVector"},render_location_enum:{type:"Enum",required:!0,enumType:1},is_saved_on_select:{type:"Bool",defaultValue:!1},should_return_tooltip:{type:"Bool",defaultValue:!1},replace_on_select:{type:"Bool",defaultValue:!1},prefix_tooltip_with_app_privacy:{type:"Bool",defaultValue:!1},ent_id:{type:"String",required:!0},reload_selector:{type:"Bool",defaultValue:!1}})}),null);
__d("PrivacySelectorBase",["cx","fbt","Promise","regeneratorRuntime","Animation","Arbiter","ArbiterMixin","AsyncRequest","Button","CSS","CurrentUser","DataStore","DOM","Focus","Input","MenuStaticItem","PopoverButton","PopoverLoadingMenu","PrivacyConst","PrivacyIconType","PrivacySelectableMenu","PrivacySelectorCustomOption","PrivacySelectorDataStore","PrivacySelectorEvent","PrivacySelectorNewDispatcher","PrivacySelectorSavedCustomOption","Run","SubscriptionsHandler","TooltipData","XPrivacySelectorLoggingController","XPrivacySelectorSavedCustomUpdateController","XPrivacySelectorUpdateController","XUIError","$","bind","debounce","ge","mixin","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;a=babelHelpers.inherits(j,b("mixin")(b("ArbiterMixin")));i=a&&a.prototype;function j(a,c,d,e,f,g){"use strict";i.constructor.call(this),this._hasBeenCleanedUp=!1,this._syncUpdateQueue=[],this._isWaitingForSavedCustom=!1,this._config=g,b("DataStore").set(this._config.rootID,"selector",this),this._isSavedOnSelect=g.is_saved_on_select,this._privacyFBID=g.privacy_fbid,this._contentType=g.content_type,this._renderLocation=g.render_location,this._supportsTagExpansion=g.supports_tag_expansion,this._skipCleanup=g.skip_cleanup,this._prefixTooltipApps=g.should_prefix_tooltip_apps,this._shouldDisplayLabel=g.should_display_label,this._tags=g.tagged_uids,this._hasTags=this._tags.length>0,this._entID=g.ent_id,this._receivingUpdate=!1,this._selectorSyncKey=g.selector_sync_key,this._previousParam=null,this._listeners=new(b("SubscriptionsHandler"))(),this._spinnerCount=0,this._postParam=g.postParam,g.use_async_menu?this._listeners.addSubscriptions(this.getPopoverMenu().subscribe("setMenu",function(){this._menu=this.getPopoverMenu().getMenu();if(!(this._menu instanceof b("PrivacySelectableMenu")))return;this._onMenuLoad();this._onPopoverOpen();this.inform("asyncMenuLoaded")}.bind(this))):this._onMenuLoad(),(this._selectorSyncKey||this._config.hasSavedCustomPrivacy)&&this._initSelectorSync(),b("Run").onLeave(this._cleanup.bind(this))}j.prototype._cleanup=function(){"use strict";__p&&__p();if(this._skipCleanup)return;var a=this.getSelectableMenu();a instanceof b("PrivacySelectableMenu")&&a.cleanup();this._hasBeenCleanedUp=!0;this._syncUpdateQueue=[];this._syncUpdatePromise=null;this._listeners&&this._listeners.release();this._listeners=null};j.prototype._initSelectorSync=function(){"use strict";this._selectorSyncKey&&(this._listeners&&this._listeners.addSubscriptions(b("PrivacySelectorDataStore").subscribe("change",function(){if(this._selectorSyncKey==null)return;b("PrivacySelectorDataStore").get(this._selectorSyncKey,function(a){this._enqueueAndExecuteSyncUpdate({type:"regular_update",payload:a})}.bind(this))}.bind(this)))),this._config.hasSavedCustomPrivacy&&(this._listeners&&this._listeners.addSubscriptions(b("PrivacySelectorDataStore").subscribe("saved_custom_update",function(){b("PrivacySelectorDataStore").get("saved_custom_update",function(a){this._enqueueAndExecuteSyncUpdate({type:"saved_custom_update",payload:a})}.bind(this))}.bind(this))))};j.prototype._enqueueAndExecuteSyncUpdate=function(a){"use strict";this._syncUpdateQueue.push(a);if(this._syncUpdatePromise)return;this._syncUpdatePromise=this._startSyncUpdates();b("promiseDone")(this._syncUpdatePromise,this._resetSyncUpdatePromise.bind(this),this._resetSyncUpdatePromise.bind(this))};j.prototype._resetSyncUpdatePromise=function(){"use strict";this._syncUpdatePromise=null};j.prototype._startSyncUpdates=function(){"use strict";__p&&__p();return new(b("Promise"))(function(a,c){__p&&__p();var d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this._waitUntilSelectorInDOM());case 2:if(!this._hasBeenCleanedUp){e.next=5;break}c();return e.abrupt("return");case 5:while(this._syncUpdateQueue.length)d=this._syncUpdateQueue.shift(),this._executeSyncUpdate(d);a();case 7:case"end":return e.stop()}},null,this)}.bind(this))};j.prototype._executeSyncUpdate=function(a){"use strict";__p&&__p();if(a.type==="tags_changed"){this._executeTagsChangedUpdate(a.tags);return}var c=a.payload,d=this.getSelectableMenu();if(c.unique_id===d._config.id)return;this._receivingUpdate=!0;switch(a.type){case"regular_update":b("XUIError").clear(this.getTriggerButtonElement());c.post_param&&this.selectOption(c.post_param,function(){c.is_custom&&c.subtitles&&this.updateCustomOption(c.subtitles)}.bind(this));c.reload&&this.reloadSelector();c.is_error&&this._displayErrorWithoutFocus();c.post_param||(this._receivingUpdate=!1);break;case"saved_custom_update":d instanceof b("PrivacySelectableMenu")&&c.savedCustomPrivacyType!=null&&c.postParam!=null&&c.subtitles!=null&&this.updateSavedCustomOption(c.savedCustomPrivacyType,c.postParam,c.subtitles);if(!this.shouldTryToUpdateSavedCustom())return;j._savedCustomSelectorsToUpdate.push(this);j._sendSavedCustomUpdateRequest();c.postParam||(this._receivingUpdate=!1);break}};j.prototype._executeTagsChangedUpdate=function(a){"use strict";var c=!a.length;this._hasTags===c&&(this._hasTags=!!a.length,this.getSelectableMenu().updateOptionsAfterTagExpansion(this._showTagExpansion()),this._updateTriggerButtonLabelAndIcon());(this._tags.length!==a.length||a.some(function(a){return!this._tags.includes(a)}.bind(this)))&&(this._tags=a,this._updateTooltip(),b("Arbiter").inform("PrivacySelectorBase/changed",this._getChangedData()))};j.prototype.shouldTryToUpdateSavedCustom=function(){"use strict";__p&&__p();if(this.getSelectableMenu()instanceof b("PrivacySelectableMenu"))return this.getIsCustomOptionSelected()||this.getIsSavedCustomOptionSelected();var a=Object.keys(b("PrivacyConst").PostParam);for(var c=0;c<a.length;c++){var d=a[c];if(this._postParam===b("PrivacyConst").PostParam[d].toString())return!1}return!0};j.prototype._broadcastUpdate=function(){"use strict";this._broadcastUpdateImpl(!1)};j.prototype._broadcastError=function(){"use strict";this._broadcastUpdateImpl(!0)};j.prototype._broadcastUpdateImpl=function(a){"use strict";__p&&__p();if(!this._receivingUpdate){var c={};c.selector_type=this._selectorSyncKey;c.unique_id=this.getSelectableMenu()._config.id;if(a)c.is_error=a;else{a=this._getSelectedOption();if(!a)return;c.post_param=a.getPostParam();c.subtitles=a.getSubtitles();c.is_custom=a.isCustomOption();c.saved_custom_privacy_type=a.getSavedCustomPrivacyType()}b("PrivacySelectorNewDispatcher").handleUpdateFromSelector(c)}};j.prototype.disable=function(){"use strict";var a=this.getTriggerButtonElement();b("Button").setEnabled(a,!1);this.getPopover().disable();b("CSS").addClass(a,"_4swv");return this};j.prototype.enable=function(){"use strict";var a=this.getTriggerButtonElement();b("Button").setEnabled(a,!0);this.getPopover().enable();b("CSS").removeClass(a,"_4swv");return this};j.prototype.shouldReplaceOnPost=function(){"use strict";return this._config.replace_on_post};j.prototype.getSelectedTriggerIcon=function(){"use strict";return this._selectedOption&&this._selectedOption.getTriggerIcon()};j.prototype.getSelectedTriggerLabel=function(){"use strict";return this._selectedOption&&this._selectedOption.getTriggerLabel()};j.prototype.getSelectedIconType=function(){"use strict";return this._selectedOption&&this._selectedOption.getIconType()};j.prototype.getIsPublicSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isPublic()};j.prototype.getIsFBOnlySelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isFBOnly()};j.prototype.getIsFriendsSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isFriends()};j.prototype.getIsFriendsOfFriendsSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isFriendsOfFriends()};j.prototype.getIsOnlyMeSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isOnlyMe()};j.prototype.getSelectedBaseValue=function(){"use strict";return this._selectedOption&&this._selectedOption.getBaseValue()};j.prototype.getSelectedLabelString=function(){"use strict";return this._selectedOption&&this._selectedOption.getLabel()};j.prototype.getSelectedPostParam=function(){"use strict";return this._selectedOption&&this._selectedOption.getPostParam()};j.prototype.getIsCustomOptionSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isCustomOption()};j.prototype.getIsSavedCustomOptionSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isSavedCustomOption()};j.prototype.getIsSavedOnSelect=function(){"use strict";return this._isSavedOnSelect};j.prototype.getPrivacyFBID=function(){"use strict";return this._privacyFBID};j.prototype.setValue=function(a){"use strict";this.getSelectableMenu().setValue(a)};j.prototype.setIsSavedOnSelect=function(a){"use strict";this._isSavedOnSelect=a};j.prototype.getSavedCustomOptIn=function(){"use strict";return this._config.savedCustomOptIn};j.prototype.openSelectorExpanded=function(a){"use strict";this.openSelector(function(){this.getSelectableMenu().expandMenu(),a&&a()}.bind(this))};j.prototype.openSelector=function(a){"use strict";this.getSelectableMenu()instanceof b("PopoverLoadingMenu")?(this.subscribeOnce("asyncMenuLoaded",function(){a&&a()}),this.getPopover().showLayer()):(this.getPopover().showLayer(),a&&a())};j.prototype.closeSelector=function(){"use strict";this.getPopover().hideLayer()};j.prototype.getSelectableMenu=function(){"use strict";this._menu||(this._menu=this._config.getMenu());return this._menu};j.prototype.getPopover=function(){"use strict";this._popover||(this._popover=this.getPopoverMenu().getPopover());return this._popover};j.prototype.getPopoverMenu=function(){"use strict";this._popoverMenu||(this._popoverMenu=this._config.getPopoverMenu());return this._popoverMenu};j.prototype.getTriggerButtonElement=function(){"use strict";this._button||(this._button=b("$")(this._config.buttonID));return this._button};j.prototype.isSelectorInDOM=function(){"use strict";return!!b("ge")(this._config.rootID)};j.prototype._waitUntilSelectorInDOM=function(){"use strict";__p&&__p();return b("regeneratorRuntime").async(function(a){__p&&__p();while(1)switch(a.prev=a.next){case 0:if(!(!this._hasBeenCleanedUp&&!this.isSelectorInDOM())){a.next=5;break}a.next=3;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(a){return setTimeout(a,1e3)}));case 3:a.next=0;break;case 5:case"end":return a.stop()}},null,this)};j.prototype.getRoot=function(){"use strict";this._root||(this._root=b("$")(this._config.rootID));return this._root};j.prototype.getInput=function(){"use strict";this._input||(this._input=b("$")(this._config.inputID));return this._input};j.prototype.getSpinner=function(){"use strict";this._spinner||(this._spinner=b("$")(b("nullthrows")(this._config.spinnerID)));return this._spinner};j.prototype.getCheckmark=function(){"use strict";this._checkmark||(this._checkmark=b("$")(b("nullthrows")(this._config.checkmarkID)));return this._checkmark};j.prototype.getErrorIcon=function(){"use strict";this._errorIcon||(this._errorIcon=b("$")(b("nullthrows")(this._config.errorIconID)));return this._errorIcon};j.prototype.getMenuElement=function(){"use strict";return this.getSelectableMenu().getRoot()};j.prototype.selectOption=function(a,c){"use strict";if(!a)return;var d=this.getSelectableMenu();d instanceof b("PopoverLoadingMenu")?(this.subscribeOnce("asyncMenuLoaded",this._selectOptionImpl.bind(this,a,c)),this._fetchAsyncMenu()):this._selectOptionImpl(a,c)};j.prototype._selectOptionImpl=function(a,b){"use strict";__p&&__p();var c=this.getSelectableMenu();a=c.selectOption(a);!a?(c.subscribeOnce("selectOption",function(){var a=this.getIsSavedOnSelect();this.setIsSavedOnSelect(!1);this._updateMenu();this.setIsSavedOnSelect(a);this._finishSpinnerSuccess();b&&b()}.bind(this)),this._showSpinner()):b&&b();this._updateMenu()};j.prototype._updateMenu=function(){"use strict";this._selectedOption=this._getSelectedOption();if(!this._selectedOption)return;this.updateDataForItemIndex(this._selectedOption.getIndex(),this._selectedOption.getPostParam())};j.prototype._fetchAsyncMenu=function(){"use strict";this._config.use_async_menu&&this.getPopoverMenu().fetchMenu()};j.prototype._getSelectedOption=function(){"use strict";var a=this.getSelectableMenu();return a instanceof b("PrivacySelectableMenu")?a.getSelectedOption():null};j.prototype._onItemClick=function(a,c){"use strict";a=c.item;if(a instanceof b("MenuStaticItem"))return;a.isPrivateSharingDisabledOption()?a.openDialog(this):a.isBasicOption()?this.updateDataForItemIndex(a.getIndex(),a.getPostParam()):(a.isCustomOption()||a.isSavedCustomOption())&&(this._closeForCustom=!0,a.openDialog(this));this.inform("click",{customSelected:a.isCustomOption()})};j.prototype.getContentType=function(){"use strict";return this._contentType};j.prototype.getRenderLocation=function(){"use strict";return this._renderLocation};j.prototype.getPostParam=function(){"use strict";return this._postParam};j.prototype.getTags=function(){"use strict";return this._tags};j.prototype.updateCustomOption=function(a){"use strict";var c=this.getSelectableMenu(),d=c.findOption(function(a){return a instanceof b("PrivacySelectorCustomOption")});if(d==null)return;d.setSubtitles(a);c.refreshTagExpansionLabels()};j.prototype.updateSavedCustomOption=function(a,c,d){"use strict";var e=this.getSelectableMenu(),f=e.findOption(function(c){return c instanceof b("PrivacySelectorSavedCustomOption")&&c.getSavedCustomPrivacyType()===a});if(f==null)return;f.setPostParam(c).setSubtitles(d);e.refreshTagExpansionLabels()};j.prototype.updateDataForItemIndex=function(a,c){"use strict";__p&&__p();var d=this.getSelectableMenu();a=d.getItemForIndex(String(a));if(!a)return;(a.isCustomOption()||a.isSavedCustomOption())&&a.setPostParam(c);if(!a.isCustomOption()){var e=d.findOption(function(a){return a instanceof b("PrivacySelectorCustomOption")});e!=null&&(e.setSubtitlesToNonSelected(),d.refreshTagExpansionLabels())}this._selectedOption=a;this._previousParam=this._postParam;this._postParam=c;b("Input").setValue(this.getInput(),c);this._updateTriggerButtonLabelAndIcon();this._updateTooltipAndSavePrivacyIfNeeded();this.inform("changed",{post_param:this._postParam,base_value:this.getSelectedBaseValue()})};j.prototype._shouldUpdateTooltips=function(){"use strict";return this._prefixTooltipApps||this._supportsTagExpansion&&this._hasTags||this.getIsCustomOptionSelected()||this.getIsSavedCustomOptionSelected()};j.prototype._updateTooltip=function(){"use strict";this._updateTooltipAndSavePrivacyIfNeededImpl(!1)};j.prototype._updateTooltipAndSavePrivacyIfNeeded=function(){"use strict";this._updateTooltipAndSavePrivacyIfNeededImpl(!0)};j.prototype._updateTooltipAndSavePrivacyIfNeededImpl=function(a){"use strict";this._shouldUpdateTooltips()&&this._updateTooltipToLoading(),this._sendUpdateRequest(a),this._shouldUpdateTooltips()||this._setTooltipValue(this._selectedOption.getTooltip())};j.prototype.reloadSelector=function(){"use strict";this._cleanup();var a=b("XPrivacySelectorUpdateController").getURIBuilder().setString("privacy_fbid",String(this._privacyFBID)).setString("post_param",this._postParam).setEnum("render_location_enum",this._renderLocation).setBool("reload_selector",!0).setString("ent_id",String(this._entID)).getURI();new(b("AsyncRequest"))().setRelativeTo(this.getRoot()).setHandler(this.inform.bind(this,"reloaded")).setURI(a).send()};j.prototype._sendUpdateRequest=function(a){"use strict";__p&&__p();a=a&&this._isSavedOnSelect&&!this._receivingUpdate;var c=this._shouldUpdateTooltips();if(!a&&!c){this._receivingUpdate=!1;return}a&&this._showSpinner();c=b("XPrivacySelectorUpdateController").getURIBuilder().setString("privacy_fbid",String(this._privacyFBID)).setString("post_param",this._postParam).setIntVector("tags",this._tags).setEnum("render_location_enum",this._renderLocation).setBool("is_saved_on_select",a).setBool("should_return_tooltip",c).setBool("prefix_tooltip_with_app_privacy",this._prefixTooltipApps).setBool("replace_on_select",this._config.replace_on_select).setString("ent_id",String(this._entID)).getURI();this._updateRequest&&this._updateRequest.abandon();this._updateRequest=new(b("AsyncRequest"))(c).setRelativeTo(this.getRoot()).setHandler(function(b){a&&(this._finishSpinnerSuccess(),this._broadcastUpdate());this._config.replace_on_select&&this._cleanup();var c=b&&b.payload&&b.payload.tooltip;c&&this._setTooltipValue(b.payload.tooltip);this.inform("selector_updated")}.bind(this)).setFinallyHandler(function(a){this._receivingUpdate=!1,this._updateRequest=null}.bind(this));a&&this._updateRequest.setErrorHandler(b("bind")(this,function(a){if(this._receivingUpdate){this._displayErrorWithoutFocus();return}this.getSelectableMenu().selectOption(this._previousParam);this._postParam=this._previousParam;this._displayError();this._broadcastError()}));this._updateRequest.send()};j.prototype.animateSavedCustomSave=function(){"use strict";if(this._isWaitingForSavedCustom)return;this._showSpinner();this._updateTooltipToLoading();this._shouldDisplayLabel&&this._updateTriggerToLoading();this._isWaitingForSavedCustom=!0};j.prototype.finishAnimatingSavedCustomSave=function(){"use strict";if(!this._isWaitingForSavedCustom)return;this._finishSpinnerSuccess();this._isWaitingForSavedCustom=!1};j.prototype._showSpinner=function(){"use strict";__p&&__p();if(!this._shouldDisplaySuccessAndFailure())return;if(!this.getIsSavedOnSelect())return;if(this._spinnerCount===0){var a=this.getTriggerButtonElement(),c=this.getSpinner();b("XUIError").clear(a);b("Button").setIcon(a,c);b("CSS").show(c);b("CSS").hide(this.getCheckmark())}this._spinnerCount++};j.prototype._finishSpinnerSuccess=function(){"use strict";__p&&__p();if(!this._shouldDisplaySuccessAndFailure())return;if(!this.getIsSavedOnSelect())return;this._spinnerCount--;if(this._spinnerCount===0){b("CSS").hide(this.getSpinner());this._updateTriggerButtonLabelAndIcon();var a=this.getCheckmark();if(a){var c=this.getTriggerButtonElement(),d=b("Button").getIcon(c);b("Button").setIcon(c,a);b("CSS").hide(d);new(b("Animation"))(a).show().from("opacity",0).to("opacity",1).duration(400).checkpoint().duration(200).checkpoint().from("opacity",1).to("opacity",0).duration(400).hide().ondone(function(){this._updateTriggerButtonLabelAndIcon(),new(b("Animation"))(d).show().from("opacity",0).to("opacity",1).duration(300).go()}.bind(this)).go()}}};j.prototype._displayError=function(){"use strict";if(!this._shouldDisplaySuccessAndFailure())return;this._spinnerCount--;this._displayErrorImpl(!0)};j.prototype._displayErrorWithoutFocus=function(){"use strict";this._displayErrorImpl(!1)};j.prototype._displayErrorImpl=function(a){"use strict";__p&&__p();if(!this._shouldDisplaySuccessAndFailure())return;var c=this.getTriggerButtonElement(),d=this.getErrorIcon();b("PopoverButton").setLabel(c,h._("Select Audience"));b("Button").setIcon(c,d);b("CSS").show(d);b("TooltipData").remove(c);a&&b("Focus").setWithoutOutline(c);b("XUIError").set({target:c,message:h._("Your selection might not have been saved. We recommend trying again later.")})};j.prototype.informTagsChanged=function(a){"use strict";a=this._getTags(a);this.informTagsChangedWithIDs(a)};j.prototype.informTagsChangedWithIDs=function(a){"use strict";this._enqueueAndExecuteSyncUpdate({type:"tags_changed",tags:a})};j.prototype._getChangedData=function(){"use strict";return{tags:this._tags,privacy:this.getSelectedBaseValue()}};j.prototype._showTagExpansion=function(){"use strict";return this._hasTags};j.prototype._getTags=function(a){"use strict";__p&&__p();var c=[],d=b("CurrentUser").getID();if(a.withTags)for(var e=0;e<a.withTags.length;e++){var f=a.withTags[e].info;f.uid!=d&&c.push(f.uid.toString())}if(a.mention)for(var g in a.mention)a.mention[g].type=="user"&&a.mention[g].uid!=d&&c.push(a.mention[g].uid.toString());return c};j.prototype._updateTriggerButtonLabelAndIcon=function(){"use strict";__p&&__p();if(this._shouldDisplaySuccessAndFailure()&&this._spinnerCount===0){var a=this.getTriggerButtonElement(),c=this._selectedOption.getTriggerIcon();this._config.trigger_no_icon&&b("CSS").hide(c);b("Button").setIcon(a,c.cloneNode());b("CSS").conditionClass(b("Button").getIcon(a),"_21or",this.getSelectedIconType()===b("PrivacyIconType").EVERYONE)}if(!this._shouldDisplayLabel)return;this._isWaitingForSavedCustom||b("PopoverButton").setLabel(this.getTriggerButtonElement(),this._selectedOption.getTriggerLabel())};j.prototype._getLoadingText=function(){"use strict";return h._("Loading...")};j.prototype._updateTooltipToLoading=function(){"use strict";this._setTooltipValue(this._getLoadingText())};j.prototype._updateTriggerToLoading=function(){"use strict";b("PopoverButton").setLabel(this.getTriggerButtonElement(),this._getLoadingText())};j.prototype._setTooltipValue=function(a){"use strict";a&&b("TooltipData").set(this.getTriggerButtonElement(),a)};j.prototype._onPopoverClose=function(){"use strict";if(!this._getSelectedOption())return;var a=b("XPrivacySelectorLoggingController").getURIBuilder().setString("content_type",this._contentType).setEnum("event",b("PrivacySelectorEvent").CLOSE_MENU).setString("privacy_fbid",this._privacyFBID!=null?String(this._privacyFBID):null).setEnum("render_location",this._renderLocation).setBool("saved_custom_opt_in",this._config.savedCustomOptIn).getURI();new(b("AsyncRequest"))().setURI(a).send();this._closeForCustom?this._closeForCustom=!1:this.inform("selectorFinished");this.inform("close")};j.prototype._onPopoverOpen=function(){"use strict";var a=this.getSelectableMenu();if(!(a instanceof b("PrivacySelectableMenu")))return;b("Arbiter").inform("composerprivacy/aborteducation");a.onPopoverOpen(this._getSelectedOption());a=b("XPrivacySelectorLoggingController").getURIBuilder().setString("content_type",this._contentType).setEnum("event",b("PrivacySelectorEvent").OPEN_MENU).setString("privacy_fbid",this._privacyFBID!=null?String(this._privacyFBID):null).setEnum("render_location",this._renderLocation).setBool("saved_custom_opt_in",this._config.savedCustomOptIn).getURI();new(b("AsyncRequest"))().setURI(a).send();this.inform("open")};j.prototype._onMenuLoad=function(){"use strict";var a=this.getSelectableMenu();this._listeners&&this._listeners.addSubscriptions(a.subscribe("itemclick",this._onItemClick.bind(this)),this.getPopover().subscribe("hide",this._onPopoverClose.bind(this)),this.getPopover().subscribe("show",this._onPopoverOpen.bind(this)));this._listeners&&this._listeners.addSubscriptions(a.subscribe(["expandMenu","expandMenuWithMore"],function(){this.getPopover()&&this.getPopover().getLayer()&&this.getPopover().getLayer().updatePosition(),this._selectedOption=this._getSelectedOption()}.bind(this)));this._selectedOption=this._getSelectedOption();this._selectedOption&&(this._postParam=this._selectedOption.getPostParam().toString(),this._previousParam=this._postParam,this._hasAudienceExpansion()&&this._updateTriggerButtonLabelAndIcon())};j.prototype._hasAudienceExpansion=function(){"use strict";return this._hasTags};j.prototype._shouldDisplaySuccessAndFailure=function(){"use strict";return!!((this._config.spinner||this._config.spinnerID)&&(this._config.checkmark||this._config.checkmarkID)&&(this._config.error_icon||this._config.errorIconID))};j._savedCustomSelectorsToUpdate=[];j._sendSavedCustomUpdateRequest=b("debounce")(function(){__p&&__p();var a=j._savedCustomSelectorsToUpdate;j._savedCustomSelectorsToUpdate=[];var c={},d={},e=!1;for(var f=a,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;c[i._postParam]=!0;d[i._config.trigger_style]=!0;e=e||i._menu instanceof b("PopoverLoadingMenu")}this._savedCustomUpdateRequest&&this._savedCustomUpdateRequest.abandon();this._savedCustomUpdateRequest=new(b("AsyncRequest"))(b("XPrivacySelectorSavedCustomUpdateController").getURIBuilder().getURI()).setData({has_async_menu:e,post_params:Object.keys(c),trigger_icon_styles:Object.keys(d)}).setHandler(function(c){__p&&__p();c=c.payload||{};var d=c.post_param_map||{};c=c.data||{};var e=b("DOM").create("div",{className:"hidden_elem"});for(var f=a,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;var j=d[i._postParam];if(!j)continue;if(i._menu instanceof b("PopoverLoadingMenu")){var k=c[j]||{};i._postParam=j;if(!i._config.trigger_no_icon){var l=k.icons[i._config.trigger_style];if(l!=null){b("DOM").setContent(e,l);l=e.firstChild;b("Button").setIcon(i._button,l)}}if(i._shouldDisplayLabel){l=k.label;l!=null&&b("PopoverButton").setLabel(i._button,l)}}else i._menu instanceof b("PrivacySelectableMenu")&&(i._receivingUpdate=!0,i.selectOption(j),i._receivingUpdate=!1)}b("DOM").remove(e)}).setFinallyHandler(function(){this._savedCustomUpdateRequest=null}.bind(this));this._savedCustomUpdateRequest.send()}.bind(this),10,this);e.exports=j}),null);